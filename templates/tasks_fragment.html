<div id="tasks" class="tasks-list">
  {% if tasks %}
  <table class="task-table">
    <thead>
      <tr>
        <th class="task-status-col"></th>
        <th>Task</th>
        <th>Schedule</th>
        <th>Status</th>
        <th>Last Run</th>
        <th class="task-actions-col">Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for task in tasks %}
      <tr class="task-row {{ task.status.value }}-task" data-task-id="{{ task.id }}">
        <td class="task-status-col">
          <div class="task-priority {{ task.priority.value }}">
            <div class="priority-indicator"></div>
          </div>
        </td>
        <td>
          <div class="task-title-container">
            <div class="task-title">
              {{ task.title }}
            </div>
            {% if task.category %}
            <div class="task-category" style="background-color: {{ task.category.color }}">
              {% if task.category.icon %}
              <i data-feather="{{ task.category.icon }}" class="category-icon"></i>
              {% endif %}
              {{ task.category.name }}
            </div>
            {% endif %}
            {% if task.tags %}
            <div class="task-tags">
              {% for tag in task.tags %}
              <span class="task-tag">{{ tag }}</span>
              {% endfor %}
            </div>
            {% endif %}
          </div>
        </td>
        <td>
          <div class="task-schedule">
            <div class="cron-expression">{{ task.cron_expression }}</div>
            <div class="cron-description">{{ task.cron_expression | cron_description }}</div>
          </div>
        </td>
        <td>
          <div class="task-status status-{{ task.status.value }}">
            {{ task.status.value | title }}
            {% if task.status.value == 'snoozed' and task.snoozed_until %}
            <div class="snooze-until">until {{ format_datetime(task.snoozed_until) }}</div>
            {% endif %}
          </div>
        </td>
        <td>
          <div class="last-run">
            {% if task.last_run %}
            {{ format_datetime(task.last_run) }}
            <div class="run-count">{{ task.run_count }} times</div>
            {% else %}
            Never
            {% endif %}
          </div>
        </td>
        <td class="task-actions-col">
          <div class="task-actions">
            <button class="action-btn view-task-btn" data-task-id="{{ task.id }}" title="View Details">
              <i data-feather="eye"></i>
            </button>
            
            {% if task.status.value == 'pending' %}
            <form hx-post="/tasks/{{ task.id }}/complete" hx-target="#tasks" hx-swap="outerHTML">
              <button type="submit" class="action-btn complete-btn" title="Mark as Completed">
                <i data-feather="check"></i>
              </button>
            </form>
            
            <form hx-post="/tasks/{{ task.id }}/snooze" hx-target="#tasks" hx-swap="outerHTML">
              <input type="hidden" name="hours" value="24">
              <button type="submit" class="action-btn snooze-btn" title="Snooze for 24h">
                <i data-feather="clock"></i>
              </button>
            </form>
            {% endif %}
            
            {% if task.status.value == 'completed' or task.status.value == 'snoozed' %}
            <form hx-post="/tasks/{{ task.id }}/reactivate" hx-target="#tasks" hx-swap="outerHTML">
              <button type="submit" class="action-btn reactivate-btn" title="Reactivate">
                <i data-feather="refresh-cw"></i>
              </button>
            </form>
            {% endif %}
            
            <form hx-delete="/tasks/{{ task.id }}" hx-target="#tasks" hx-swap="outerHTML" hx-confirm="Delete this task?">
              <button type="submit" class="action-btn delete-btn" title="Delete Task">
                <i data-feather="trash-2"></i>
              </button>
            </form>
          </div>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% else %}
  <div class="empty-state">
    <div class="empty-icon">
      <i data-feather="calendar"></i>
    </div>
    <h3>No tasks found</h3>
    <p>Add your first task using the form</p>
  </div>
  {% endif %}
</div>
